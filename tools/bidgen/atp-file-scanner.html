<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ATP File Scanner & Importer</title>
    <meta name="robots" content="noindex, nofollow">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background: #1a1a2e; color: #eee; min-height: 100vh; }
        .container { max-width: 1400px; margin: 0 auto; padding: 30px 20px; }
        h1 { font-size: 28px; margin-bottom: 4px; color: #e8e8e8; }
        .subtitle { color: #7f8c8d; font-size: 14px; margin-bottom: 30px; }
        
        .location-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; margin-bottom: 30px; }
        .location-card { background: #16213e; border: 1px solid #2a3a5c; border-radius: 10px; padding: 20px; }
        .location-card h3 { color: #3498db; margin-bottom: 15px; font-size: 16px; }
        .file-count { color: #27ae60; font-weight: 600; margin-bottom: 10px; }
        .file-list { max-height: 200px; overflow-y: auto; }
        .file-item { padding: 8px 12px; margin-bottom: 5px; background: #0f1a33; border-radius: 6px; font-size: 12px; display: flex; justify-content: space-between; align-items: center; cursor: pointer; transition: all 0.2s; }
        .file-item:hover { background: #1a2744; }
        .file-item.selected { background: #27ae60; color: white; }
        .file-size { color: #7f8c8d; font-size: 11px; }
        
        .card { background: #16213e; border: 1px solid #2a3a5c; border-radius: 10px; padding: 24px; margin-bottom: 20px; }
        .card h2 { font-size: 16px; color: #3498db; margin-bottom: 16px; text-transform: uppercase; letter-spacing: 1px; display: flex; align-items: center; gap: 8px; }
        .card h2 .icon { width: 28px; height: 28px; background: #3498db; color: white; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 14px; font-weight: bold; }
        
        .btn { padding: 14px 28px; border: none; border-radius: 8px; font-size: 14px; font-weight: 600; cursor: pointer; transition: all 0.2s; display: inline-flex; align-items: center; gap: 8px; }
        .btn-primary { background: #3498db; color: white; }
        .btn-primary:hover { background: #2980b9; }
        .btn-success { background: #27ae60; color: white; }
        .btn-success:hover { background: #2ecc71; }
        .btn-warning { background: #f39c12; color: white; }
        .btn-warning:hover { background: #e67e22; }
        .btn-danger { background: #e74c3c; color: white; }
        .btn-danger:hover { background: #c0392b; }
        
        .stats-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-top: 20px; }
        .stat-box { text-align: center; padding: 20px; background: #0f1a33; border-radius: 8px; border: 1px solid #2a3a5c; }
        .stat-value { font-size: 24px; font-weight: 700; color: #3498db; margin-bottom: 5px; }
        .stat-label { font-size: 11px; color: #7f8c8d; text-transform: uppercase; letter-spacing: 0.5px; }
        
        .progress-bar { width: 100%; height: 8px; background: #2a3a5c; border-radius: 4px; overflow: hidden; margin: 15px 0; }
        .progress-fill { height: 100%; background: #3498db; transition: width 0.3s; }
        
        .selected-files { background: #0f1a33; border: 1px solid #2a3a5c; border-radius: 8px; padding: 15px; margin: 15px 0; max-height: 150px; overflow-y: auto; }
        .selected-file { padding: 5px 10px; margin: 2px 0; background: #27ae60; color: white; border-radius: 4px; font-size: 11px; display: inline-block; margin-right: 5px; }
        
        .action-buttons { display: flex; gap: 10px; flex-wrap: wrap; margin-top: 20px; }
    </style>
</head>
<body>

<div class="container">
    <h1>ATP File Scanner & Importer</h1>
    <p class="subtitle">Scan all personal folders for ATP-related files and import them in bulk</p>

    <!-- DISCOVERED LOCATIONS -->
    <div class="card">
        <h2><span class="icon">üîç</span> Discovered ATP Files</h2>
        <div class="location-grid" id="locationGrid">
            <!-- File locations will be populated here -->
        </div>
    </div>

    <!-- SELECTION SUMMARY -->
    <div class="card">
        <h2><span class="icon">üìã</span> Selection Summary</h2>
        <div class="stats-grid">
            <div class="stat-box">
                <div class="stat-value" id="totalLocations">0</div>
                <div class="stat-label">Locations Scanned</div>
            </div>
            <div class="stat-box">
                <div class="stat-value" id="totalFiles">0</div>
                <div class="stat-label">Total Files Found</div>
            </div>
            <div class="stat-box">
                <div class="stat-value" id="selectedFiles">0</div>
                <div class="stat-label">Files Selected</div>
            </div>
            <div class="stat-box">
                <div class="stat-value" id="atpFiles">0</div>
                <div class="stat-label">ATP Files</div>
            </div>
        </div>
        
        <div class="selected-files" id="selectedFilesContainer">
            <p style="color: #7f8c8d; font-size: 12px;">No files selected yet</p>
        </div>
    </div>

    <!-- ACTIONS -->
    <div class="card">
        <h2><span class="icon">‚ö°</span> Bulk Actions</h2>
        <div class="action-buttons">
            <button class="btn btn-primary" onclick="selectAllATP()">üè¢ Select All ATP Files</button>
            <button class="btn btn-success" onclick="selectAll()">üìÑ Select All Files</button>
            <button class="btn btn-warning" onclick="clearSelection()">üóëÔ∏è Clear Selection</button>
            <button class="btn btn-danger" onclick="importSelected()">üöÄ Import Selected Files</button>
        </div>
        
        <div class="progress-bar" id="importProgress" style="display: none;">
            <div class="progress-fill" id="progressFill" style="width: 0%;"></div>
        </div>
        <div id="importStatus" style="margin-top: 10px; font-size: 12px; color: #7f8c8d;"></div>
    </div>
</div>

<script>
// Discovered ATP file locations
const atpFileLocations = {
    'Downloads': {
        path: 'c:\\Users\\User\\Downloads',
        files: [
            'ATP-Material-Funding-Auth-Docs-2026-2.0.pdf',
            'ATP-Material-Funding-Auth-Docs-2026.pdf',
            'Atp-Materials-Jayne-Allen-2026.pdf',
            'atp-quote-misc-2025_pdf.pdf',
            'Allen_Quote_Form- Bathroom_rev_ATP-25 2.0 11.20.pdf',
            'Allen_Quote_Form- Bathroom_rev_ATP-25 11.20.pdf',
            'Allen_Quote_Form- Bathroom_rev_ATP-25 11.20 (1).pdf',
            'Justin Watts NorthPark EST#12539.pdf',
            'Justin Watts Cover 2025.pdf',
            'wattssafetyinstalls_estimate_1.pdf',
            'Watts, Justin Onyx Preview.pdf',
            'Watts Safety Installs Fed EIN 2025.pdf',
            'My Applicants - Watts Safety Installs - 10_16_2025.csv',
            'My Applicants - Watts Safety Installs - 10_16_2025 (1).csv'
        ]
    },
    'OneDrive Documents': {
        path: 'c:\\Users\\User\\OneDrive\\Documents',
        files: [
            'ATP-Material-Funding-Auth-Docs-2026.pdf',
            'ATP-S.Smith-Quote-1-22-2026.pdf',
            'Atp-Materials-Jayne-Allen-2026-V3.pdf',
            'Allen_Quote_Form- Bathroom_rev_ATP-25 11.20.pdf',
            'EsperanzaBathroomQuoteForm-Complete_WSI-26.pdf',
            'PleasantQuote_Form- Bath_Complete-2026.pdf',
            'WSI-North-Park-Quote-2025.pdf',
            'WSI-Financial-Details.csv',
            'WSI-Financials-2025_V3.csv',
            'bulk-Info-WSI-2025.csv'
        ]
    },
    'Documents Bid Folder': {
        path: 'c:\\Users\\User\\Documents\\bid-documents',
        files: [
            'index.html',
            'labor-estimate.html',
            'materials-estimate.html',
            'change-order.html'
        ]
    },
    'Watts-HQ': {
        path: 'c:\\Users\\User\\Watts-HQ',
        files: [
            '.git' // Git repository, may contain project files
        ]
    }
};

// Global state
let selectedFiles = new Set();
let allFiles = [];

// Initialize
document.addEventListener('DOMContentLoaded', () => {
    scanAllLocations();
});

function scanAllLocations() {
    const locationGrid = document.getElementById('locationGrid');
    locationGrid.innerHTML = '';
    
    let totalFiles = 0;
    let atpFiles = 0;
    
    Object.entries(atpFileLocations).forEach(([locationName, locationData]) => {
        const isAtpLocation = locationName.toLowerCase().includes('atp') || 
                           locationName.toLowerCase().includes('watts') ||
                           locationName.toLowerCase().includes('downloads') ||
                           locationName.toLowerCase().includes('onedrive');
        
        const locationFiles = locationData.files.map(filename => {
            const isAtp = isAtpFile(filename);
            if (isAtp) atpFiles++;
            totalFiles++;
            
            return {
                name: filename,
                path: locationData.path,
                isAtp: isAtp,
                size: estimateFileSize(filename),
                selected: false
            };
        });
        
        allFiles.push(...locationFiles);
        
        const locationCard = document.createElement('div');
        locationCard.className = 'location-card';
        locationCard.innerHTML = `
            <h3>üìÅ ${locationName}</h3>
            <div class="file-count">${locationFiles.length} files (${locationFiles.filter(f => f.isAtp).length} ATP)</div>
            <div class="file-list">
                ${locationFiles.map(file => `
                    <div class="file-item ${file.isAtp ? 'atp-file' : ''}" 
                         onclick="toggleFile('${file.name}', '${file.path}', this)"
                         data-filename="${file.name}"
                         data-path="${file.path}">
                        <span>${file.name}</span>
                        <span class="file-size">${file.size}</span>
                    </div>
                `).join('')}
            </div>
        `;
        
        locationGrid.appendChild(locationCard);
    });
    
    updateStats(totalFiles, atpFiles);
}

function isAtpFile(filename) {
    const atpPatterns = [
        'atp', 'watts', 'justin watts', 'wsi', 'watts safety', 'bid', 'quote', 
        'estimate', 'contract', 'proposal', 'north park', 'allen', 'smith', 
        'kent', 'esperanza', 'pleasant', 'jayne'
    ];
    
    const lowerFilename = filename.toLowerCase();
    return atpPatterns.some(pattern => lowerFilename.includes(pattern));
}

function estimateFileSize(filename) {
    // Rough file size estimation based on extension
    const ext = filename.split('.').pop().toLowerCase();
    const sizeMap = {
        'pdf': '~1MB',
        'doc': '~500KB',
        'docx': '~500KB',
        'csv': '~50KB',
        'html': '~100KB',
        'txt': '~10KB'
    };
    
    return sizeMap[ext] || '~100KB';
}

function toggleFile(filename, path, element) {
    const fileKey = `${path}\\${filename}`;
    
    if (selectedFiles.has(fileKey)) {
        selectedFiles.delete(fileKey);
        element.classList.remove('selected');
    } else {
        selectedFiles.add(fileKey);
        element.classList.add('selected');
    }
    
    updateSelectedFilesDisplay();
    updateStats();
}

function selectAllATP() {
    document.querySelectorAll('.atp-file').forEach(element => {
        const filename = element.dataset.filename;
        const path = element.dataset.path;
        
        if (!element.classList.contains('selected')) {
            toggleFile(filename, path, element);
        }
    });
}

function selectAll() {
    document.querySelectorAll('.file-item').forEach(element => {
        const filename = element.dataset.filename;
        const path = element.dataset.path;
        
        if (!element.classList.contains('selected')) {
            toggleFile(filename, path, element);
        }
    });
}

function clearSelection() {
    selectedFiles.clear();
    document.querySelectorAll('.file-item.selected').forEach(element => {
        element.classList.remove('selected');
    });
    updateSelectedFilesDisplay();
    updateStats();
}

function updateSelectedFilesDisplay() {
    const container = document.getElementById('selectedFilesContainer');
    
    if (selectedFiles.size === 0) {
        container.innerHTML = '<p style="color: #7f8c8d; font-size: 12px;">No files selected yet</p>';
        return;
    }
    
    const fileNames = Array.from(selectedFiles).map(fileKey => {
        return fileKey.split('\\').pop();
    });
    
    container.innerHTML = fileNames.map(filename => 
        `<span class="selected-file">${filename}</span>`
    ).join('');
}

function updateStats(total = null, atp = null) {
    if (total !== null) {
        document.getElementById('totalFiles').textContent = total;
    } else {
        document.getElementById('totalFiles').textContent = allFiles.length;
    }
    
    if (atp !== null) {
        document.getElementById('atpFiles').textContent = atp;
    } else {
        document.getElementById('atpFiles').textContent = allFiles.filter(f => f.isAtp).length;
    }
    
    document.getElementById('totalLocations').textContent = Object.keys(atpFileLocations).length;
    document.getElementById('selectedFiles').textContent = selectedFiles.size;
}

async function importSelected() {
    if (selectedFiles.size === 0) {
        alert('Please select files to import first!');
        return;
    }
    
    const progressContainer = document.getElementById('importProgress');
    const progressFill = document.getElementById('progressFill');
    const statusText = document.getElementById('importStatus');
    
    progressContainer.style.display = 'block';
    statusText.textContent = 'Starting import...';
    
    let processed = 0;
    const total = selectedFiles.size;
    let importedCount = 0;
    
    for (const fileKey of selectedFiles) {
        const [path, filename] = fileKey.split('\\').slice(0, -1).join('\\') + '\\' + fileKey.split('\\').pop();
        
        try {
            // Simulate file processing
            await processFile(filename, path);
            importedCount++;
            statusText.textContent = `Imported ${filename}`;
        } catch (error) {
            console.error('Error importing file:', filename, error);
            statusText.textContent = `Error importing ${filename}`;
        }
        
        processed++;
        const percentage = (processed / total) * 100;
        progressFill.style.width = percentage + '%';
        
        await new Promise(resolve => setTimeout(resolve, 100)); // Small delay for visual effect
    }
    
    statusText.textContent = `‚úÖ Import complete! Successfully imported ${importedCount} of ${total} files.`;
    
    setTimeout(() => {
        progressContainer.style.display = 'none';
        alert(`Import complete! ${importedCount} files processed successfully.`);
    }, 2000);
}

async function processFile(filename, path) {
    // Simulate file processing - in real implementation, this would:
    // 1. Read the actual file content
    // 2. Extract bid data
    // 3. Store in your ATP database
    // 4. Update competitive intelligence
    
    console.log(`Processing: ${path}\\${filename}`);
    
    // Simulate processing time
    await new Promise(resolve => setTimeout(resolve, 50));
    
    return {
        filename: filename,
        path: path,
        status: 'success',
        extractedData: {
            amount: Math.random() * 10000,
            won: Math.random() > 0.5,
            competitors: []
        }
    };
}
</script>

</body>
</html>
